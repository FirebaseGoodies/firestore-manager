<nz-spin nzTip="Loading..." [nzSpinning]="isLoading" [ngStyle]="{ 'min-height': '150px' }">
  <div nz-row nzGutter="16">
    <div nz-col nzSpan="6" [ngStyle]="{ 'max-height': '300px', overflow: 'auto' }">
      <nz-tree
        [nzData]="collectionNodes"
        nzShowLine
        [nzExpandedIcon]="expandedIconTpl"
        [nzTreeTemplate]="treeTpl"
        (nzClick)="onCollectionNodeClick($event)"
      >
        <ng-template #expandedIconTpl let-node>
          <i *ngIf="!node.origin.isLeaf" nz-icon [nzType]="node.isExpanded ? 'folder-open' : 'folder'" class="ant-tree-switcher-line-icon"></i>
          <i *ngIf="node.origin.isLeaf" nz-icon nzType="file" class="ant-tree-switcher-line-icon"></i>
        </ng-template>
        <ng-template #treeTpl let-node>
          <span class="custom-node" [class.active]="node.isSelected">
            <span *ngIf="!node.isLeaf">{{ node.title }}</span>
            <span *ngIf="node.isLeaf" [ngClass]="{ 'new-node': isNewNode(node), 'removed-node': isRemovedNode(node) }">{{ node.title }}</span>
          </span>
        </ng-template>
      </nz-tree>
    </div>
    <div
      *ngIf="diff"
      nz-col nzSpan="18"
      [ngStyle]="{ 'max-height': '300px', overflow: 'auto' }"
    >
      <div nz-row [ngStyle]="{ 'margin-bottom': '15px' }">
        <div nz-col nzSpan="8">
          <nz-radio-group [(ngModel)]="diffStyle" nzSize="small" (ngModelChange)="reloadDiff()">
              <label nz-radio-button nzValue="word">Word diff</label>
            <label nz-radio-button nzValue="char">Char diff</label>
          </nz-radio-group>
        </div>
        <div nz-col nzSpan="8" nzOffset="8">
          <nz-radio-group [(ngModel)]="outputFormat" nzSize="small" (ngModelChange)="reloadDiff()" [ngStyle]="{ 'float': 'right' }">
            <label nz-radio-button nzValue="side-by-side">Side by Side</label>
            <label nz-radio-button nzValue="line-by-line">Line by Line</label>
          </nz-radio-group>
        </div> 
      </div>
      <div [innerHtml]="diffOutput"></div>
    </div>
  </div>
  <nz-empty
    *ngIf="!isLoading && !diff"
    nzNotFoundContent="No unsaved changes"
  ></nz-empty>
</nz-spin>
